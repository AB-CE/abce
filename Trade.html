

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Trade &mdash; ABCE 0.3.1alpha documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.3.1alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ABCE 0.3.1alpha documentation" href="index.html" />
    <link rel="next" title="Firm and production" href="Firm.html" />
    <link rel="prev" title="Agents" href="Agent_class.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Firm.html" title="Firm and production"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Agent_class.html" title="Agents"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">ABCE 0.3.1alpha documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="trade">
<h1>Trade<a class="headerlink" href="#trade" title="Permalink to this headline">¶</a></h1>
<<<<<<< HEAD
<dl class="class">
<dt id="abce.Trade">
<em class="property">class </em><tt class="descclassname">abce.</tt><tt class="descname">Trade</tt><a class="headerlink" href="#abce.Trade" title="Permalink to this definition">¶</a></dt>
<dd><p>Agents can trade with each other. The clearing of the trade is taken care
of fully by ABCE.
Selling a good works in the following way:</p>
<ol class="arabic">
<li><p class="first">An agent sends an offer. <tt class="xref py py-meth docutils literal"><span class="pre">sell()</span></tt></p>
<p><em>The good offered is blocked and self.possession(...) does not account for it.</em></p>
</li>
<li><p class="first"><strong>Next subround:</strong> An agent receives the offer <tt class="xref py py-meth docutils literal"><span class="pre">get_offers()</span></tt>, and can
<tt class="xref py py-meth docutils literal"><span class="pre">accept()</span></tt>, <tt class="xref py py-meth docutils literal"><span class="pre">reject()</span></tt> or partially accept it. <tt class="xref py py-meth docutils literal"><span class="pre">accept_partial()</span></tt></p>
<p><em>The good is credited and the price is deducted from the agent&#8217;s possesions.</em></p>
</li>
<li><p class="first"><strong>Next subround:</strong></p>
<ul class="simple">
<li>in case of acceptance <em>the money is automatically credited.</em></li>
<li>in case of partial acceptance <em>the money is credited and part of the blocked good is unblocked.</em></li>
<li>in case of rejection <em>the good is unblocked.</em></li>
</ul>
</li>
</ol>
<p>Analogously for buying. (<tt class="xref py py-meth docutils literal"><span class="pre">buy()</span></tt>)</p>
<p>Example:</p>
<div class="highlight-python"><pre># Agent 1
def sales(self):
    self.remember_trade = self.sell('Household', 0, 'cookies', quantity=5, price=self.price)

# Agent 2
def receive_sale(self):
    oo = self.get_offers('cookies')
    for offer in oo:
        if offer['price'] &lt; 0.3:
            try:
                self.accept(offer)
            except NotEnoughGoods:
                self.accept_partial(offer, self.possession('money') / offer['price'])
        else:
            self.reject(offer)

# Agent 1, subround 3
def learning(self):
    offer = self.info(self.remember_trade)
    if offer['status'] == 'reject':
        self.price *= .9
    elif offer['status'] = 'partial':
        self.price *= offer['final_quantity'] / offer['quantity']</pre>
</div>
<p>Quotes on the other hand allow you to ask a trade partner to send you a not committed price quote.
The modeller has to implement a response mechanism. For convenience <tt class="xref py py-meth docutils literal"><span class="pre">accept_quote()</span></tt> and
<tt class="xref py py-meth docutils literal"><span class="pre">accept_quote_partial()</span></tt>, send a committed offer that it is the uncommitted price quote.</p>
<dl class="method">
<dt id="abce.Trade.accept">
<tt class="descname">accept</tt><big>(</big><em>offer</em><big>)</big><a class="headerlink" href="#abce.Trade.accept" title="Permalink to this definition">¶</a></dt>
<dd><p>The offer is accepted and cleared</p>
<p>Args:</p>
<div class="highlight-python"><pre>offer: the offer the other party made
(offer not quote!)</pre>
</div>
<dl class="docutils">
<dt>Return:</dt>
<dd>Returns a dictionary with the good&#8217;s quantity and the amount paid.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.accept_max_possible">
<tt class="descname">accept_max_possible</tt><big>(</big><em>offer</em><big>)</big><a class="headerlink" href="#abce.Trade.accept_max_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO The offer is partly accepted and cleared</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>offer: the offer the other party made
(offer not quote!)</dd>
<dt>Return:</dt>
<dd>Returns a dictionary with the good&#8217;s quantity and the amount paid.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.accept_partial">
<tt class="descname">accept_partial</tt><big>(</big><em>offer</em>, <em>quantity</em><big>)</big><a class="headerlink" href="#abce.Trade.accept_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO The offer is partly accepted and cleared</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>offer: the offer the other party made
(offer not quote!)</dd>
<dt>Return:</dt>
<dd>Returns a dictionary with the good&#8217;s quantity and the amount paid.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.accept_partial_max_possible">
<tt class="descname">accept_partial_max_possible</tt><big>(</big><em>offer</em>, <em>quantity</em><big>)</big><a class="headerlink" href="#abce.Trade.accept_partial_max_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO The offer is partly accepted and cleared</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>offer: the offer the other party made
(offer not quote!)</dd>
<dt>Return:</dt>
<dd>Returns a dictionary with the good&#8217;s quantity and the amount paid.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.accept_quote">
<tt class="descname">accept_quote</tt><big>(</big><em>quote</em><big>)</big><a class="headerlink" href="#abce.Trade.accept_quote" title="Permalink to this definition">¶</a></dt>
<dd><p>makes a commited buy or sell out of the counterparties quote</p>
<dl class="docutils">
<dt>Args::</dt>
<dd>quote: buy or sell quote that is accepted</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.accept_quote_partial">
<tt class="descname">accept_quote_partial</tt><big>(</big><em>quote</em>, <em>quantity</em><big>)</big><a class="headerlink" href="#abce.Trade.accept_quote_partial" title="Permalink to this definition">¶</a></dt>
<dd><p>makes a commited buy or sell out of the counterparties quote</p>
<dl class="docutils">
<dt>Args::</dt>
<dd>quote: buy or sell quote that is accepted
quantity: the quantity that is offered/requested
it should be less than propsed in the quote, but this is not enforced.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.buy">
<tt class="descname">buy</tt><big>(</big><em>receiver_group</em>, <em>receiver_idn</em>, <em>good</em>, <em>quantity</em>, <em>price</em><big>)</big><a class="headerlink" href="#abce.Trade.buy" title="Permalink to this definition">¶</a></dt>
<dd><p>commits to sell the quantity of good at price</p>
<p>The goods are not in haves or self.count(). When the offer is
rejected it is automatically re-credited. When the offer is
accepted the money amount is credited. (partial acceptance
accordingly)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>receiver_group: an agent name  NEVER a group or &#8216;all&#8217;!
(it is an error but with a confusing warning)
&#8216;good&#8217;: name of the good
quantity: maximum units disposed to buy at this price
price: price per unit</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.buy_max_possible">
<tt class="descname">buy_max_possible</tt><big>(</big><em>receiver_group</em>, <em>receiver_idn</em>, <em>good</em>, <em>quantity</em>, <em>price</em><big>)</big><a class="headerlink" href="#abce.Trade.buy_max_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as buy but if money is insufficient, it executes the deal with
a lower amount of goods using all available money.</p>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.get_offers">
<tt class="descname">get_offers</tt><big>(</big><em>good</em>, <em>descending=False</em><big>)</big><a class="headerlink" href="#abce.Trade.get_offers" title="Permalink to this definition">¶</a></dt>
<dd><p>returns all offers of the &#8216;good&#8217; ordered by price.</p>
<p><em>Offers that are not accepted in the same subround (def block) are
automatically rejected.</em> However you can also manualy reject.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>good:</dt>
<dd>the good which should be retrieved</dd>
<dt>descending(bool,default=False):</dt>
<dd>False for descending True for ascending by price</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A list of offers ordered by price</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">offers</span> <span class="o">=</span> <span class="n">get_offers</span><span class="p">(</span><span class="s">&#39;books&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">offer</span> <span class="ow">in</span> <span class="n">offers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">offer</span><span class="p">[</span><span class="s">&#39;price&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">(</span><span class="n">offer</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">offer</span><span class="p">[</span><span class="s">&#39;price&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept_partial</span><span class="p">(</span><span class="n">offer</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">(</span><span class="n">offer</span><span class="p">)</span>  <span class="c"># optional</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.get_offers_all">
<tt class="descname">get_offers_all</tt><big>(</big><em>descending=False</em><big>)</big><a class="headerlink" href="#abce.Trade.get_offers_all" title="Permalink to this definition">¶</a></dt>
<dd><p>returns all offers in a dictionary, with goods as key. The in each
goods-category the goods are ordered by price. The order can be reversed
by setting descending=True</p>
<p><em>Offers that are not accepted in the same subround (def block) are
automatically rejected.</em> However you can also manualy reject.</p>
<p>Args:</p>
<div class="highlight-python"><pre>descending(optional): is a bool. False for descending True for
                      ascending by price</pre>
</div>
<p>Example2:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">oo</span> <span class="o">=</span> <span class="n">get_offers_all</span><span class="p">(</span><span class="n">descending</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">for</span> <span class="n">good_category</span> <span class="ow">in</span> <span class="n">oo</span><span class="p">:</span>
   <span class="k">print</span><span class="p">(</span><span class="s">&#39;The cheapest good of category&#39;</span> <span class="o">+</span> <span class="n">good_category</span>
   <span class="o">+</span> <span class="s">&#39; is &#39;</span> <span class="o">+</span> <span class="n">good_category</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c">#sorted list of beer prices and seller</span>
<span class="k">for</span> <span class="n">offer</span> <span class="ow">in</span> <span class="n">oo</span><span class="p">[</span><span class="s">&#39;beer&#39;</span><span class="p">]:</span>
   <span class="k">print</span><span class="p">(</span><span class="n">offer</span><span class="p">[</span><span class="s">&#39;price&#39;</span><span class="p">],</span> <span class="n">offer</span><span class="p">[</span><span class="s">&#39;sender&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Lists can only efficiently pop the last item. Therefore it is more
efficient to order backwards and buy the last good first:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">buy_input_good</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
   <span class="n">offers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_offers_all</span><span class="p">(</span><span class="n">descending</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
   <span class="k">while</span> <span class="n">offers</span><span class="p">:</span>
       <span class="k">if</span> <span class="n">offers</span><span class="p">[</span><span class="n">good</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;quantity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">prices_for_which_buy</span><span class="p">[</span><span class="n">good</span><span class="p">]:</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">(</span><span class="n">offers</span><span class="p">[</span><span class="n">good</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.get_quotes">
<tt class="descname">get_quotes</tt><big>(</big><em>good</em>, <em>descending=False</em><big>)</big><a class="headerlink" href="#abce.Trade.get_quotes" title="Permalink to this definition">¶</a></dt>
<dd><p>self.get_quotes() returns all new quotes and removes them. The order
is randomized.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>good:</dt>
<dd>the good which should be retrieved</dd>
<dt>descending(bool,default=False):</dt>
<dd>False for descending True for ascending by price</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>list of quotes ordered by price</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">quotes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_quotes</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.get_quotes_all">
<tt class="descname">get_quotes_all</tt><big>(</big><em>descending=False</em><big>)</big><a class="headerlink" href="#abce.Trade.get_quotes_all" title="Permalink to this definition">¶</a></dt>
<dd><p>self.get_quotes_all() returns a dictionary with all now new quotes ordered
by the good type and removes them. The order is randomized.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>descending(bool,default=False):</dt>
<dd>False for descending True for ascending by price</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>dictionary of list of quotes ordered by price. The dictionary
itself is ordered by price.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">quotes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_quotes</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.give">
<tt class="descname">give</tt><big>(</big><em>receiver_group</em>, <em>receiver_idn</em>, <em>good</em>, <em>quantity</em><big>)</big><a class="headerlink" href="#abce.Trade.give" title="Permalink to this definition">¶</a></dt>
<dd><p>gives a good to another agent</p>
<p>Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>receiver_group:</dt>
<dd>Group name of the receiver</dd>
<dt>receiver_idn:</dt>
<dd>id number of the receiver</dd>
<dt>good:</dt>
<dd>the good to be transfered</dd>
<dt>quantity:</dt>
<dd>amount to be transfered</dd>
</dl>
</div></blockquote>
<p>Raises:</p>
<blockquote>
<div>AssertionError, when good smaller than 0.</div></blockquote>
<dl class="docutils">
<dt>Return:</dt>
<dd>Dictionary, with the transfer, which can be used by self.log(...).</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><pre>self.log('taxes', self.give('money': 0.05 * self.possession('money'))</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.info">
<tt class="descname">info</tt><big>(</big><em>offer_idn</em><big>)</big><a class="headerlink" href="#abce.Trade.info" title="Permalink to this definition">¶</a></dt>
<dd><p>lets you access all fields of a <strong>given</strong> offer.
This allows you to check whether an offer was accepted, partially accepted
or rejected and retrieve the quantity actually traded.</p>
<p>If in your first round the value you are testing is not set, set the variable
to <cite>None</cite>. None in the first round returns an empty trade with quantity = 0 and price = 1.
The status in accepted.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Example</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_offer</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="k">def</span> <span class="nf">selling</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last_offer</span><span class="p">)[</span><span class="s">&#39;status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;accept&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_offer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sell</span><span class="p">(</span><span class="s">&#39;Household&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&#39;cookies&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">price</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Returns a dictionary; Fields:</dt>
<dd><dl class="first last docutils">
<dt>[&#8216;status&#8217;]:</dt>
<dd><dl class="first last docutils">
<dt>&#8216;accepted&#8217;:</dt>
<dd>trade fully accepted</dd>
<dt>&#8216;partial&#8217;:</dt>
<dd>[&#8216;final_quantity&#8217;] and self.offer_partial_status_percentage(...)
for the quantities actually accepted</dd>
<dt>&#8216;rejected&#8217;:</dt>
<dd>trade rejected</dd>
<dt>&#8216;pending&#8217;:</dt>
<dd>offer has not yet answered, and is not older than one round.</dd>
<dt>&#8216;perished&#8217;:</dt>
<dd>the <strong>perishable</strong> good was not accepted by the end of the round
and therefore perished.</dd>
</dl>
</dd>
<dt>[&#8216;quantity&#8217;]:</dt>
<dd>the quantity of the original quote.</dd>
<dt>[&#8216;final_quantity&#8217;]:</dt>
<dd><dl class="first last docutils">
<dt>This returns the actual quantity bought or sold. (Equal to quantity</dt>
<dd>if the offer was accepted fully)</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Raises:</dt>
<dd><dl class="first last docutils">
<dt>KeyError:</dt>
<dd>If the offer was answered more than one round ago.</dd>
</dl>
</dd>
</dl>
<p>Example Pending:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">offer_idn</span><span class="p">)[</span><span class="s">&#39;status&#39;</span><span class="p">]</span>
<span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s">&#39;pending&#39;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">&#39;offer has not yet been answered&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-python"><pre>from pybrain.rl.learners.valuebased import ActionValueTable
from pybrain.rl.agents import LearningAgent
from pybrain.rl.learners import Q

def __init__(self):
    controller = ActionValueTable(dimState=1, numActions=1)
    learner = Q()
    rl_price = LearningAgent(controller, learner)
    self.car_cost = 500

def sales(self):
    price = reinforcement_learner.getAction():
    self.offer = self.sell('Household', 1, 'car', 1, price)

def learn(self):
    reinforcement_learner.integrateObservation([self.info(self.offer)])
    reinforcement_learner.giveReward([self.info(self.offer) * price - self.car_cost])</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.partial_status_percentage">
<tt class="descname">partial_status_percentage</tt><big>(</big><em>offer_idn</em><big>)</big><a class="headerlink" href="#abce.Trade.partial_status_percentage" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the percentage of a partial accept</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>offer_idn:</dt>
<dd>on offer as returned by self.sell(...) ord self.buy(...)</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A value between [0, 1]</dd>
<dt>Raises:</dt>
<dd>KeyError, when no answer has been given or received more than one round before</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.peak_offers">
<tt class="descname">peak_offers</tt><big>(</big><em>good</em>, <em>descending=False</em><big>)</big><a class="headerlink" href="#abce.Trade.peak_offers" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a peak on all offers of the &#8216;good&#8217; ordered by price.
Peaked offers can not be accepted or rejected, but they do not
expire.
Args:</p>
<blockquote>
<div><dl class="docutils">
<dt>good:</dt>
<dd>the good which should be retrieved</dd>
<dt>descending(bool,default=False):</dt>
<dd>False for descending True for ascending by price</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>Returns:</dt>
<dd>A list of offers ordered by price</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">offers</span> <span class="o">=</span> <span class="n">get_offers</span><span class="p">(</span><span class="s">&#39;books&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">offer</span> <span class="ow">in</span> <span class="n">offers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">offer</span><span class="p">[</span><span class="s">&#39;price&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">(</span><span class="n">offer</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">offer</span><span class="p">[</span><span class="s">&#39;price&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accept_partial</span><span class="p">(</span><span class="n">offer</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">(</span><span class="n">offer</span><span class="p">)</span>  <span class="c"># optional</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.quote_buy">
<tt class="descname">quote_buy</tt><big>(</big><em>receiver_group</em>, <em>receiver_idn</em>, <em>good</em>, <em>quantity</em>, <em>price</em><big>)</big><a class="headerlink" href="#abce.Trade.quote_buy" title="Permalink to this definition">¶</a></dt>
<dd><p>quotes a price to buy quantity of &#8216;good&#8217; a receiver</p>
<p>price (money) per unit
offers a deal without checking or committing resources</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>receiver_group:</dt>
<dd>agent group name of the agent</dd>
<dt>receiver_idn:</dt>
<dd>the agent&#8217;s id number</dd>
<dt>&#8216;good&#8217;:</dt>
<dd>name of the good</dd>
<dt>quantity:</dt>
<dd>maximum units disposed to buy at this price</dd>
<dt>price:</dt>
<dd>price per unit</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.quote_sell">
<tt class="descname">quote_sell</tt><big>(</big><em>receiver_group</em>, <em>receiver_idn</em>, <em>good</em>, <em>quantity</em>, <em>price</em><big>)</big><a class="headerlink" href="#abce.Trade.quote_sell" title="Permalink to this definition">¶</a></dt>
<dd><p>quotes a price to sell quantity of &#8216;good&#8217; to a receiver</p>
<p>price (money) per unit
offers a deal without checking or committing resources</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt>receiver_group:</dt>
<dd>agent group name of the agent</dd>
<dt>receiver_idn:</dt>
<dd>the agent&#8217;s id number</dd>
<dt>&#8216;good&#8217;:</dt>
<dd>name of the good</dd>
<dt>quantity:</dt>
<dd>maximum units disposed to sell at this price</dd>
<dt>price:</dt>
<dd>price per unit</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.reject">
<tt class="descname">reject</tt><big>(</big><em>offer</em><big>)</big><a class="headerlink" href="#abce.Trade.reject" title="Permalink to this definition">¶</a></dt>
<dd><p>The offer is rejected</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>offer: the offer the other party made
(offer not quote!)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.retract">
<tt class="descname">retract</tt><big>(</big><em>offer_idn</em><big>)</big><a class="headerlink" href="#abce.Trade.retract" title="Permalink to this definition">¶</a></dt>
<dd><p>The agent who made a buy or sell offer can retract it</p>
<p>The offer an agent made is deleted at the end of the sub-round and the
committed good reappears in the haves. However if another agent
accepts in the same round the trade will be cleared and not retracted.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>offer: the offer he made with buy or sell
(offer not quote!)</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.sell">
<tt class="descname">sell</tt><big>(</big><em>receiver_group</em>, <em>receiver_idn</em>, <em>good</em>, <em>quantity</em>, <em>price</em><big>)</big><a class="headerlink" href="#abce.Trade.sell" title="Permalink to this definition">¶</a></dt>
<dd><p>commits to sell the quantity of good at price</p>
<p>The goods are not in haves or self.count(). When the offer is
rejected it is automatically re-credited. When the offer is
accepted the money amount is credited. (partial acceptance
accordingly)</p>
<dl class="docutils">
<dt>Args:</dt>
<dd>receiver_group: an agent name  NEVER a group or &#8216;all&#8217;!!!
(its an error but with a confusing warning)
&#8216;good&#8217;: name of the good
quantity: maximum units disposed to buy at this price
price: price per unit</dd>
<dt>Returns:</dt>
<dd>A reference to the offer. The offer and the offer status can
be accessed with <cite>self.info(offer_reference)</cite>.</dd>
</dl>
<p>Example:</p>
<div class="highlight-python"><pre>def subround_1(self):
    self.offer = self.sell('household', 1, 'cookies', quantity=5, price=0.1)

def subround_2(self):
    offer = self.info(self.offer)
    if offer['status'] == 'partial':
        print(offer['final_quantity'] , 'cookies have be bougth')
    elif:
        offer['status'] == 'accepted':
        print('Cookie monster bougth them all')
    elif:
        offer['status'] == 'rejected':
        print('On diet')</pre>
</div>
</dd></dl>

<dl class="method">
<dt id="abce.Trade.sell_max_possible">
<tt class="descname">sell_max_possible</tt><big>(</big><em>receiver_group</em>, <em>receiver_idn</em>, <em>good</em>, <em>quantity</em>, <em>price</em><big>)</big><a class="headerlink" href="#abce.Trade.sell_max_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as sell but if the possession of good is smaller than the number,
it executes the deal with a lower amount of goods using everything
available of this good.</p>
</dd></dl>

</dd></dl>

=======
>>>>>>> 462d9124f9a039bd51276d519bcced4975f1f6be
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="Agent_class.html"
                        title="previous chapter">Agents</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="Firm.html"
                        title="next chapter">Firm and production</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/Trade.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Firm.html" title="Firm and production"
             >next</a> |</li>
        <li class="right" >
          <a href="Agent_class.html" title="Agents"
             >previous</a> |</li>
        <li><a href="index.html">ABCE 0.3.1alpha documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Davoud Taghawi-Nejad.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>